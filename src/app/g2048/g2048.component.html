<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>{{ 'GAME_TITLE' | translate }}</ion-title>
    
    <ion-buttons slot="end">
      <ion-button (click)="changeLanguage('ru')" [color]="currentLang === 'ru' ? 'primary' : 'medium'">
        {{ 'FEED.RUSSIAN' | translate }}
      </ion-button>
      <ion-button (click)="changeLanguage('en')" [color]="currentLang === 'en' ? 'primary' : 'medium'">
        {{ 'FEED.ENGLISH' | translate }}
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" (keydown)="handleKeyDown($event)" tabindex="0">
  <div class="game-container" [class]="'theme-' + currentTheme">
    
    <div class="header">
      <h1>{{getTargetValue()}}</h1>
      <div class="scores">
        <div class="score-box">
          <div class="score-label">{{ 'SCORE' | translate }}</div>
          <div class="score-value">{{score}}</div>
        </div>
        <div class="score-box">
          <div class="score-label">{{ 'BEST_SCORE' | translate }}</div>
          <div class="score-value">{{bestScore}}</div>
        </div>
      </div>
    </div>

    <div class="game-controls">
      <ion-button (click)="restartGame()" color="primary">{{ 'NEW_GAME' | translate }}</ion-button>
      <ion-button (click)="changeTheme()" color="medium">{{ 'THEME_BUTTON' | translate }}</ion-button>
      <ion-button (click)="changeSize()" color="secondary">{{ 'SIZE_BUTTON' | translate }}</ion-button>
    </div>

    <div class="game-board">
      <div class="grid-container" [class]="'size-' + currentSize">
        <div class="grid-background">
          <div class="grid-row" *ngFor="let row of getGridArray()">
            <div class="grid-cell" *ngFor="let col of getGridArray()"></div>
          </div>
        </div>
        
        <div class="tiles-container">
          <div *ngFor="let tile of getAllTiles(); trackBy: trackByTileId"
               class="tile"
               [class]="getTileClass(tile)"
               [style.transform]="getTileTransform(tile)">
            <span class="tile-text">{{tile.value}}</span>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="gameOver" class="game-message game-over">
      <p>{{ 'GAME_OVER' | translate }}</p>
      <ion-button (click)="restartGame()">{{ 'TRY_AGAIN' | translate }}</ion-button>
    </div>

    <div *ngIf="won" class="game-message game-won">
      <p>{{ 'YOU_WIN' | translate }}</p>
      <ion-button (click)="restartGame()">{{ 'PLAY_AGAIN' | translate }}</ion-button>
    </div>

    <div class="instructions">
      <p><strong>{{ 'HOW_TO_PLAY' | translate }}:</strong> {{ 'INSTRUCTIONS_MOVE' | translate }}</p>
      <p>{{ 'INSTRUCTIONS_JOIN' | translate:{target: getTargetValue()} }}</p>
      <p><strong>{{ 'FIELD_SIZE' | translate }}:</strong> {{currentSize}}Ã—{{currentSize}}</p>
    </div>

  </div>
</ion-content>